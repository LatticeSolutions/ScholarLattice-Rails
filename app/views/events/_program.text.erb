\documentclass[12pt]{book}

% Adapted from "A Basic Conference Abstract Booklet"
% Author: LianTze Lim
% License: Creative Commons CC BY 4.0
% https://www.overleaf.com/latex/examples/a-basic-conference-abstract-booklet/tkjfcvzgjrnd

\usepackage[a4paper,margin=3cm,innermargin=3cm]{geometry}

\usepackage{needspace}
\usepackage{marginnote}
\renewcommand*{\marginfont}{\sffamily\footnotesize}

\usepackage{imakeidx}
\usepackage{xcolor}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    linkcolor={blue!50!black},
    citecolor={red!50!black},
    urlcolor={blue!80!black}
}
\makeindex[intoc]

\newenvironment{conf-abstract}[4][]{
  \needspace{10\baselineskip}
  \begin{center}
    { \renewcommand\textsuperscript[1]{}
      \phantomsection\addcontentsline{toc}{section}
      {\texorpdfstring{#2 (\emph{#3})}{#2 (#3)}}
    }
    {{\large\bfseries #2}\marginnote{#1}\par}
    \medskip
    {#3\par}
    \smallskip
    {\small #4\par}
  \end{center}
}{%
  \bigskip
  \hrule
  \bigskip
}

\usepackage{etoolbox}
\newcommand{\indexauthors}[1]{%
  \forcsvlist{\index}{#1}
}

\setcounter{tocdepth}{3}
\setcounter{secnumdepth}{-1}
\pagestyle{plain}

\usepackage{lipsum}

\title{<%= collection.title %>}
\date{}

\begin{document}

\frontmatter

\maketitle

\tableofcontents

\mainmatter
\chapter{Abstracts}

<% collection.subtree_submissions.where(status: :accepted).each do |s| %>
\begin{conf-abstract}<% if s.event.present? %>[<%= s.event.info_in_latex %>]<% end %>
{<%= s.title %>}
{<%= s.profile.name %>}
{<%= s.profile.affiliation %>}
\indexauthors{<%= s.profile.last_name %>!<%= s.profile.first_name %>}

<%= s.abstract %>
\end{conf-abstract}
<% end %>

\backmatter
\renewcommand{\indexname}{Author Index}
\printindex

\end{document}